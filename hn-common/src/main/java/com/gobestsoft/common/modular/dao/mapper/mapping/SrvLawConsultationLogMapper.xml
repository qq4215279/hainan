<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gobestsoft.common.modular.dao.mapper.SrvLawConsultationLogMapper">
    <!--
     WARNING - @mbg.generated
     This element is automatically generated by MyBatis Generator, do not modify.
     This element was generated on 2018-02-09 14:18:32.
    -->
    <resultMap type="com.gobestsoft.common.modular.dao.model.SrvLawConsultationLogPojo" id="BaseResult">
        <result property="id" column="id"/>
        <result property="consultationId" column="consultation_id"/>
        <result property="answerDeptId" column="answer_dept_id"/>
        <result property="transferDeptId" column="transfer_dept_id"/>
        <result property="transferReason" column="transfer_reasion"/>
        <result property="transferTime" column="transfer_time"/>
        <result property="status" column="status"/>
    </resultMap>

	<select id="selBackId" resultType="int">
		SELECT transfer_dept_id from srv_law_consultation_log where consultation_id =#{consultationId} order by transfer_time DESC LIMIT 1
	</select>
	
	<select id="logList" resultType="com.gobestsoft.common.modular.model.LogModel">
		SELECT l.id
			,l.status
			,c.create_time as createTime
			,transfer_time as checkTime
			,transfer_reasion as comment
			,(SELECT fullname from sys_dept d where answer_dept_id = d.id) answerDept
			,(SELECT fullname from sys_dept d where transfer_dept_id = d.id) fullname 
	        ,(SELECT real_name from app_user u where u.auid = c.auid) name 
	    from srv_law_consultation_log l join srv_law_consultation c on c.id=l.consultation_id where consultation_id = #{id} ORDER BY transfer_time desc
	</select>

</mapper>